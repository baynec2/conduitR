% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_taxonomy_to_qf.R
\name{add_taxonomy_to_qf}
\alias{add_taxonomy_to_qf}
\title{Add Taxonomy / LCA Annotations to a QFeatures Object}
\usage{
add_taxonomy_to_qf(qf, uniprot_annotation)
}
\arguments{
\item{qf}{A QFeatures object containing a protein assay named "protein_groups".}

\item{uniprot_annotation}{A data frame or tibble containing taxonomy information.
Must include columns: \code{domain}, \code{kingdom}, \code{phylum}, \code{class},
\code{order}, \code{family}, \code{genus}, and \code{species}.}
}
\value{
A QFeatures object with:
\itemize{
\item Taxonomy columns added to the protein assay rowData.
\item A new \code{lca} column representing the lowest common ancestor for each protein group.
}
}
\description{
This function assigns a Lowest Common Ancestor (LCA) taxonomy to each
protein group in a QFeatures object. It uses the taxonomy of each protein
within a group and collapses them to the most specific shared taxonomic level
(domain â†’ species). The full taxonomy columns and the computed LCA are added
to the protein assay's rowData.
}
\examples{
\dontrun{
qf <- add_lca_to_qf(
  qf,
  uniprot_annotation = uniprot_taxonomy_df
)
# Access LCA column
rowData(qf[["protein_groups"]])$lca
}
}
