% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_relative_abundance.R
\name{calc_relative_abundance}
\alias{calc_relative_abundance}
\title{Calculate Relative Abundance for a QFeatures Assay}
\usage{
calc_relative_abundance(qf, assay_name)
}
\arguments{
\item{qf}{A QFeatures object containing the abundance data. The assay should contain
non-negative abundance values (e.g., protein intensities or species counts).}

\item{assay_name}{Character string specifying which assay to use for calculating
relative abundances. The assay must exist in the QFeatures object.}
}
\value{
A QFeatures object with an additional assay named "{assay_name}_rel_abundance"
containing:
\itemize{
\item Values normalized to proportions (0-1)
\item Same dimensions as the input assay
\item NA values preserved from the input
\item Column sums equal to 1 for each sample (excluding NA values)
}
The original assays remain unchanged.
}
\description{
Calculates the relative abundance of features (e.g., proteins or species) within each
sample of a QFeatures assay by normalizing the raw abundance values to proportions.
This function adds a new assay containing the relative abundance values to the
QFeatures object, making it easy to compare the composition of features across samples.
}
\note{
This function:
\itemize{
\item Preserves NA values from the input data
\item Normalizes each sample independently
\item Handles zero values appropriately
\item Maintains the original assay structure
}
For large datasets, consider:
\itemize{
\item Filtering low-abundance features before calculation
\item Using add_relative_abundance_assays() for multiple assays
}
}
\examples{
# Calculate relative abundance for a protein assay:
# qf_with_rel_abundance <- calc_relative_abundance(qfeatures_obj, "protein")

# Access the relative abundance assay:
# rel_abundance <- assay(qf_with_rel_abundance, "protein_rel_abundance")

# Use with plotting functions:
# plot_relative_abundance(qf_with_rel_abundance, "protein_rel_abundance")

# Use with downstream analysis:
# perform_limma_analysis(qf_with_rel_abundance, "protein_rel_abundance", ~group, "groupB - groupA")

}
\seealso{
\itemize{
\item \code{\link[add_relative_abundance_assays]{add_relative_abundance_assays}} for
calculating relative abundances for multiple assays
\item \code{\link[plot_relative_abundance]{plot_relative_abundance}} for visualizing
the relative abundance data
}
}
