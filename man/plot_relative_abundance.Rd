% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_relative_abundance.R
\name{plot_relative_abundance}
\alias{plot_relative_abundance}
\title{Plot Relative Abundance of Features Across Samples}
\usage{
plot_relative_abundance(qf, assay_name, facet_formula)
}
\arguments{
\item{qf}{A QFeatures object containing the abundance data. The assay should contain
non-negative abundance values (e.g., protein intensities or species counts).}

\item{assay_name}{Character string specifying which assay to use for plotting.
The assay should contain the raw abundance values that will be converted to
relative abundances.}

\item{facet_formula}{Optional formula for faceting the plot (e.g., ~group or ~treatment + timepoint).
This allows for comparing relative abundances across different experimental groups
or conditions.}
}
\value{
A ggplot object containing a stacked bar plot with:
\itemize{
\item X-axis showing samples (labels hidden to prevent overcrowding)
\item Y-axis showing relative abundance (0-100\%)
\item Stacked bars colored by feature (e.g., protein or species)
\item Optional faceting based on the provided formula
\item Legend showing feature names
\item Free x-axis scales within facets to optimize space usage
}
The plot is designed to show the proportional composition of features
within each sample, making it easy to identify dominant features and
compare patterns across samples or groups.
}
\description{
Creates a stacked bar plot showing the relative abundance of features (e.g., proteins or species)
across all samples in a QFeatures object. Each bar represents a sample, with the
height of each segment representing the relative abundance of a feature. The function
automatically calculates relative abundances by normalizing each sample to 100\%,
making it easy to compare the composition of features across samples.
}
\note{
The input data should contain non-negative abundance values. For large datasets
(e.g., >1000 features), consider the following:
\itemize{
\item Filter to the most abundant features before plotting to improve readability
\item Use facet_formula to split the visualization into smaller, more manageable plots
\item Consider using a subset of samples if the dataset is very large
}
The function uses tidy_conduit() internally to reshape the data, which may require
significant memory for large datasets. For optimal performance, pre-filter the data
to include only the features of interest.
}
\examples{
# Basic relative abundance plot:
# plot_relative_abundance(qfeatures_obj, "protein")

# With faceting by experimental group:
# plot_relative_abundance(qfeatures_obj, "protein", ~group)

# With faceting by multiple variables:
# plot_relative_abundance(qfeatures_obj, "protein", ~treatment + timepoint)

# The resulting plot can be customized further:
# p <- plot_relative_abundance(qfeatures_obj, "protein", ~group)
# p + ggplot2::theme_minimal() +
#     ggplot2::scale_fill_viridis_d() +
#     ggplot2::labs(title = "Protein Relative Abundance by Group")

}
\seealso{
\code{\link[tidy_conduit]{tidy_conduit}} for the data reshaping function used internally
}
