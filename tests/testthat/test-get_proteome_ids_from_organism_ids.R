# Simple Test
test_that("Simple Test works", {
  organism_ids = c("9606", "818")
  expect_no_error(get_proteome_ids_from_organism_ids(organism_ids))
})

# These IDs were briefly problematic
prob =c(10090,818,927665,1339352,1401073,1339280,457389,1287488,1339350,328812,
  357276,1574265,246787,46506,28116,821,1679444,47678,1780376,371601,162156,
  820,823,1739298,338188,674529,1796613,239935,1965650,871325,77133,2024223,
  2320102,2486468,28111,2486471,349741,449673,2030927,2489214,39491,2292240,
  702446,471870,484018,626522,537013,679189,469590,563193,657314,470145,
  226186,679935,908612,997884,679937,997887,997873,657309,665953,457387,709991,
  997881,469585,997877,585544,556259,742817,868129,888743,762982,817,667015,
  188937,295405,999418,742726,999419,742727,1262753,880074,547042,1235785,
  702447,397290,1262986,1235786,397291,397288)

test_that("it works with problematic ids", {
  expect_no_error(get_proteome_ids_from_organism_ids(as.character(prob)))
})

# These IDs were also problematic at some point
test_that("it works with new problematic ids",{
    problematic_ids = c(77133,2320102)
    out = get_proteome_ids_from_organism_ids(problematic_ids)
})

# Was having a problem where some ids were silently dropped- this happens if the
# proteome for that taxa is not in the uniprot database.
test_that("you get the same number out as you put in",{
  # These IDs are from Sho, its a realistic set size.
  ids <- c(
    2173, 1263088, 2317, 1860157, 1197717, 457415, 508460, 1906168, 1262868, 79604,
    446660, 671266, 580026, 1473216, 502558, 471189, 84112, 147207, 147206, 1499681,
    74426, 1262850, 1871022, 42817, 1747, 43675, 2047, 419015, 230143, 78344, 1689,
    1680, 1681, 158787, 762212, 1683, 762209, 762211, 1329411, 762210, 983706, 216816,
    1685, 55565, 544580, 544581, 1659, 461393, 184870, 1661, 29303, 1118058, 712121,
    178339, 1660, 52773, 1711, 209880, 218538, 1263072, 1262980, 29466, 1000569,
    1000568, 626940, 1262914, 187327, 1263033, 905, 36834, 84024, 29363, 1561, 1492,
    214853, 1736, 33033, 1852373, 938289, 1776392, 1871336, 1261, 1263100, 261299,
    1505, 1476973, 1496, 1263005, 1776384, 270498, 1851429, 1262775, 1930012, 39488,
    1262879, 105841, 1263014, 649756, 411489, 1262862, 33043, 290052, 1896990,
    1262782, 1703332, 796942, 43995, 936595, 1262824, 1262842, 1512, 1262792, 411486,
    154046, 84030, 333367, 457421, 358743, 208479, 1263064, 1263065, 1263066, 1531,
    39496, 1263062, 45851, 384638, 39485, 1262845, 1262994, 397287, 1263012, 1226325,
    1855376, 1432052, 1042156, 39490, 1235790, 397288, 397290, 360807, 166486,
    301301, 140626, 39491, 301302, 1896976, 1150298, 1262757, 341220, 1322, 33035,
    1263061, 53443, 180164, 1262964, 40520, 1226324, 1262755, 1263107, 1078091,
    742723, 1263069, 29361, 180311, 1235792, 342942, 39482, 33038, 1720300, 33039,
    1263108, 592978, 46228, 1653434, 1632013, 1745713, 1896996, 410072, 1519438,
    1262872, 39486, 88431, 1896999, 29347, 1235798, 160404, 1263025, 1262814,
    1263021, 501571, 1828554, 39484, 1697794, 1897029, 1263004, 1650661, 552398,
    1673721, 3062493, 1297617, 292800, 106588, 1519439, 1262992, 1897030, 1897011,
    1226323, 3083063, 1897033, 1262886, 1262882, 1262798, 1262848, 1262890, 1897020,
    1263068, 1535, 1262989, 1776382, 1697793, 1720313, 3062437, 1550024, 1650663,
    214851, 853, 1897006, 1871018, 2897707, 169435, 1235835, 1870991, 84026, 39492,
    1897004, 1161942, 40519, 1930001, 1160721, 3062497, 1896986, 154288, 1712675,
    1504823, 1547, 29348, 341225, 1658109, 100884, 1468449, 61171, 1852366, 118748,
    102148, 1903263, 1034346, 1697790, 1232449, 1735, 1323, 39483, 1263016, 1871030,
    1263076, 31971, 552396, 457402, 1522, 1834207, 658657, 1262981, 908340, 198467,
    1664069, 1402, 1549811, 1423, 1390, 492670, 936599, 1007654, 1449047, 84135,
    1284, 1295, 283734, 1286, 61015, 246432, 29385, 28035, 1283, 308354, 1280, 1292,
    29388, 1282, 1640, 1642, 1639, 180295, 166939, 1351, 1352, 53345, 1363, 1358,
    1307, 1318, 68892, 1303, 28037, 1328, 1338, 45634, 1302, 1305, 1309, 1304, 1308,
    315405, 1311, 1314, 361101, 47715, 1597, 1582, 60520, 1244, 1245, 1633, 97478,
    1613, 1581062, 1625, 103810, 28139, 626932, 1470347, 1897041, 2585118, 28117,
    214856, 328814, 1930002, 1465754, 1288121, 1547597, 544645, 544644, 1263090,
    1897010, 28118, 1841857, 322095, 823, 574930, 328812, 387661, 1263094, 487174,
    397865, 1501392, 1807744, 1262754, 1263042, 1263056, 821, 376805, 310298,
    376804, 387090, 310297, 1841865, 246787, 626931, 46506, 820, 626930, 1347393,
    291644, 1263046, 817, 310300, 871325, 1263044, 1263054, 818, 1897051, 1263037,
    338188, 1263045, 1263050, 556259, 28116, 1263095, 454155, 76122, 1852370,
    1676614, 363265, 28127, 386414, 28125, 419005, 28128, 28130, 1287488, 1284775,
    305719, 1131336, 1574265, 1574264, 1262691, 3134035, 239935, 1263034, 1929996,
    1896967, 1638783, 35833, 44742, 1262706, 1638782, 1896971, 1637509, 1262986,
    487175, 1263099, 847, 80866, 1244513, 291995, 157784, 43263, 43306, 65741, 53412,
    319939, 300, 729, 582, 1581059, 82983, 632, 1484157, 158822, 565, 357233, 28141,
    435910, 399742, 83655, 550, 61646, 1334193, 61647, 158877, 379893, 580, 51288,
    548, 573, 54291, 571, 28901, 546, 35703, 562, 622, 623, 1681196, 566, 1158459,
    61648, 563
  )
  in_length = length(ids)
  out = get_proteome_ids_from_organism_ids(ids)
  out_length = nrow(out)
  expect_equal(length(ids_not_in_output), 0)
}

# Test for duplicate ids
test_that("it works with duplicate ids",{
  ids = c(77133,77133)
  expect_no_error(get_proteome_ids_from_organism_ids(ids))
})




